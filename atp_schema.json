{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Agent Task Protocol (ATP) v1.3",
  "description": "Schema for defining a dependency-based execution graph for AI Agents.",
  "type": "object",
  "required": ["meta", "nodes"],
  "properties": {
    "meta": {
      "type": "object",
      "required": ["project_name", "version", "project_status"],
      "properties": {
        "project_name": {
          "type": "string",
          "description": "The human-readable name of the goal."
        },
        "version": {
          "type": "string",
          "const": "1.3"
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "project_status": {
          "type": "string",
          "enum": ["DRAFT", "ACTIVE", "PAUSED", "ARCHIVED"],
          "description": "DRAFT prevents execution. ACTIVE allows agents to claim tasks."
        }
      }
    },
    "nodes": {
      "type": "object",
      "description": "A map of Node IDs to Node Objects.",
      "patternProperties": {
        "^[a-zA-Z0-9_-]+$": {
          "type": "object",
          "required": ["title", "instruction", "dependencies", "status"],
          "properties": {
            "title": {
              "type": "string",
              "description": "Short label for the UI."
            },
            "instruction": {
              "type": "string",
              "description": "The System Prompt/Instruction for the Worker Agent."
            },
            "context": {
              "type": "string",
              "description": "Optional static context provided by the Architect."
            },
            "dependencies": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Array of Node IDs that must be COMPLETED before this node becomes READY."
            },
            "status": {
              "type": "string",
              "enum": ["LOCKED", "READY", "CLAIMED", "COMPLETED", "FAILED"],
              "default": "LOCKED"
            },
            "worker_id": {
              "type": "string"
            },
            "started_at": {
              "type": "string",
              "format": "date-time"
            },
            "completed_at": {
              "type": "string",
              "format": "date-time"
            },
            "artifacts": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "List of file paths or URIs created by the agent."
            },
            "report": {
              "type": "string",
              "description": "The knowledge transfer text generated by the agent after completion."
            }
          }
        }
      }
    }
  }
}
